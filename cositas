##creo tabla
create table if not exists alumnEgres(
    CURSO_ACADEMICO int,
    LOCALIDAD varchar(100),
    ESTUDIO varchar(100),
    TIPO_ESTUDIO varchar(100),
    TIPO_EGRESO varchar(100),
    SEXO varchar(100),
    ALUMNOS_GRADUADOS int,
    ALUMNOS_INTERRUMPEN_ESTUDIOS int,
    ALUMNOS_INTERRUMPEN_EST_ANO1 int,
    ALUMNOS_TRASLADAN_OTRA_UNIV int,
    DURACION_MEDIA_GRADUADOS double,
    TASA_EFICIENCIA double,
    FECHA_ACTUALIZACION date
);

##importo csv y controlo campos
LOAD DATA INFILE '/var/lib/mysql-files/alumnEgres19.csv'
INTO TABLE alumnEgres
FIELDS TERMINATED BY ';'
LINES TERMINATED BY '\r\n'
IGNORE 1 LINES
(@CURSO_ACADEMICO, @LOCALIDAD, @ESTUDIO, @TIPO_ESTUDIO, @TIPO_EGRESO, @SEXO, @ALUMNOS_GRADUADOS, @ALUMNOS_INTERRUMPEN_ESTUDIOS, @ALUMNOS_INTERRUMPEN_EST_ANO1, @ALUMNOS_TRASLADAN_OTRA_UNIV, @DURACION_MEDIA_GRADUADOS, @TASA_EFICIENCIA, @FECHA_ACTUALIZACION)
SET CURSO_ACADEMICO = IF(@CURSO_ACADEMICO = '', NULL, @CURSO_ACADEMICO),
    LOCALIDAD = IF(@LOCALIDAD = '', NULL, @LOCALIDAD),
    ESTUDIO = IF(@ESTUDIO = '', NULL, @ESTUDIO),
    TIPO_ESTUDIO = IF(@TIPO_ESTUDIO = '', NULL, @TIPO_ESTUDIO),
    TIPO_EGRESO = IF(@TIPO_EGRESO = '', NULL, @TIPO_EGRESO),
    SEXO = IF(@SEXO = '', NULL, @SEXO),
    ALUMNOS_GRADUADOS = IF(@ALUMNOS_GRADUADOS = '', NULL, @ALUMNOS_GRADUADOS),
    ALUMNOS_INTERRUMPEN_ESTUDIOS = IF(@ALUMNOS_INTERRUMPEN_ESTUDIOS = '', NULL, @ALUMNOS_INTERRUMPEN_ESTUDIOS),
    ALUMNOS_INTERRUMPEN_EST_ANO1 = IF(@ALUMNOS_INTERRUMPEN_EST_ANO1 = '', NULL, @ALUMNOS_INTERRUMPEN_EST_ANO1),
    ALUMNOS_TRASLADAN_OTRA_UNIV = IF(@ALUMNOS_TRASLADAN_OTRA_UNIV = '', NULL, @ALUMNOS_TRASLADAN_OTRA_UNIV),
    DURACION_MEDIA_GRADUADOS = IF(@DURACION_MEDIA_GRADUADOS = '', NULL, @DURACION_MEDIA_GRADUADOS),
    TASA_EFICIENCIA = IF(@TASA_EFICIENCIA = '', NULL, @TASA_EFICIENCIA),
    SEXO = IF(@SEXO = '', NULL, @SEXO),
    FECHA_ACTUALIZACION = STR_TO_DATE(REPLACE(@FECHA_ACTUALIZACION, "/", "-"), '%d-%m-%Y');




